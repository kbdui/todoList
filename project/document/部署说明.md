# Todo List 部署说明

## 📦 部署文件清单

部署时需要包含以下文件：

```
TodoList/
├── project.exe (或 project)  # 可执行文件
├── start.bat (Windows)       # Windows 启动脚本
├── start.sh (Linux/macOS)    # Linux/macOS 启动脚本
├── config.toml               # 配置文件
└── database/                 # 数据库目录（自动创建）
    └── .gitkeep             # Git 占位文件
```

## 🔨 编译发布版本

### Windows
```bash
cd project
cargo build --release
```
编译后的可执行文件位于：`target\release\project.exe`

### Linux/macOS
```bash
cd project
cargo build --release
chmod +x target/release/project
```
编译后的可执行文件位于：`target/release/project`

## 📂 准备部署包

### 1. 创建部署目录
```bash
mkdir TodoList
cd TodoList
```

### 2. 复制必要文件

**Windows (PowerShell):**
```powershell
# 复制可执行文件
Copy-Item ..\target\release\project.exe .

# 复制配置文件
Copy-Item ..\config.toml .

# 复制启动脚本
Copy-Item ..\start.bat .

# 创建数据库目录
New-Item -ItemType Directory -Path database
Copy-Item ..\database\.gitkeep database\
```

**Linux/macOS (Bash):**
```bash
# 复制可执行文件
cp ../target/release/project .
chmod +x project

# 复制配置文件
cp ../config.toml .

# 复制启动脚本
cp ../start.sh .
chmod +x start.sh

# 创建数据库目录
mkdir -p database
cp ../database/.gitkeep database/
```

### 3. 打包（可选）
```bash
# Windows: 打包成 zip
Compress-Archive -Path TodoList -DestinationPath TodoList.zip

# Linux/macOS: 打包成 tar.gz
tar -czf TodoList.tar.gz TodoList/
```

## 🚀 用户使用方式

### Windows 用户
1. 解压到任意目录（如：`C:\MyApps\TodoList\`）
2. 双击 `start.bat` 启动程序
3. 或创建 `start.bat` 的快捷方式到桌面

**创建桌面快捷方式：**
- 右键 `start.bat` → 发送到 → 桌面快捷方式
- 可以修改快捷方式图标和名称

### Linux/macOS 用户
1. 解压到任意目录（如：`~/Applications/TodoList/`）
2. 在终端中执行：
   ```bash
   cd ~/Applications/TodoList
   ./start.sh
   ```
3. 或创建别名：
   ```bash
   # 添加到 ~/.bashrc 或 ~/.zshrc
   alias todolist='cd ~/Applications/TodoList && ./start.sh'
   ```

## ⚙️ 配置说明

### config.toml
```toml
[database]
path = "todo.db"  # 数据库文件名（将存储在 database/ 目录中）
```

### 目录结构
- **可执行文件**：程序主文件
- **config.toml**：配置文件（与可执行文件同目录）
- **database/**：数据库存储目录（首次运行自动创建 todo.db）

## ⚠️ 重要注意事项

### 必须使用启动脚本
❌ **错误方式：**
```bash
# 从其他目录直接运行可执行文件
C:\Users\用户名> C:\MyApps\TodoList\project.exe  # 会找不到 config.toml
```

✅ **正确方式：**
```bash
# 使用启动脚本
双击 start.bat  # Windows
./start.sh      # Linux/macOS
```

### 为什么需要启动脚本？
程序需要从其所在目录启动才能正确找到：
- `config.toml` 配置文件
- `database/` 数据目录

启动脚本会自动切换到正确的目录。

## 🔧 故障排除

### 问题：提示 "Failed to find config.toml"
**原因：** 程序没有从正确的目录启动

**解决：** 
1. 使用 `start.bat` 或 `start.sh` 启动
2. 确保 `config.toml` 与可执行文件在同一目录

### 问题：无法创建数据库文件
**原因：** 没有写入权限

**解决：**
- Windows: 不要安装在 `C:\Program Files\` 等系统目录
- Linux/macOS: 确保当前用户有写入权限
- 建议安装在用户目录下

### 问题：双击启动脚本窗口一闪而过
**原因：** 程序启动失败或立即退出

**解决：**
1. 在命令行/终端中手动运行启动脚本查看错误信息
2. 检查配置文件格式是否正确
3. 查看是否有权限问题

## 📋 版本更新

更新程序时只需替换可执行文件：
1. 关闭正在运行的程序
2. 用新版本的可执行文件替换旧的 `project.exe` (或 `project`)
3. 保留 `config.toml` 和 `database/` 目录
4. 重新启动程序

## 🎯 高级用户选项

### 添加到系统 PATH（可选）

**Windows:**
1. 将 TodoList 目录添加到系统 PATH
2. 创建批处理文件 `todo.bat` 在 PATH 中：
   ```batch
   @echo off
   cd /d C:\MyApps\TodoList
   start.bat
   ```

**Linux/macOS:**
添加到 `~/.bashrc` 或 `~/.zshrc`：
```bash
export PATH="$HOME/Applications/TodoList:$PATH"
alias todo='cd ~/Applications/TodoList && ./start.sh'
```

然后可以在任意位置执行 `todo` 命令启动程序。

