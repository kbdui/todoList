# æé†’åŠŸèƒ½å®ç°æ€»ç»“ï¼ˆV2ç‰ˆæœ¬ - æ™ºèƒ½è‡ªåŠ¨åŒ–ï¼‰

## âœ… å®ç°å®Œæˆ

### æ ¸å¿ƒæ”¹è¿›

ç›¸æ¯”ä¹‹å‰çš„ç‰ˆæœ¬ï¼ŒV2ç‰ˆæœ¬å®ç°äº†**å®Œå…¨è‡ªåŠ¨åŒ–**çš„è®¾ç½®æµç¨‹ï¼š

- âŒ **æ—§æ–¹å¼**ï¼šç”¨æˆ·éœ€è¦æ‰‹åŠ¨è¿è¡Œ `setup_reminder_task.ps1` è„šæœ¬
- âœ… **æ–°æ–¹å¼**ï¼šåœ¨åº”ç”¨ä¸­å¯ç”¨æé†’åŠŸèƒ½ï¼Œé‡å¯ç¨‹åºè‡ªåŠ¨å®Œæˆæ‰€æœ‰è®¾ç½®

## ğŸ“‹ å®ç°å†…å®¹

### 1. æ™ºèƒ½å¯åŠ¨è„šæœ¬ï¼ˆ`scripts/run.bat`ï¼‰

**åŠŸèƒ½**ï¼šå¯åŠ¨æ—¶è‡ªåŠ¨æ£€æµ‹å’Œè®¾ç½®å®šæ—¶ä»»åŠ¡

**é€»è¾‘æµç¨‹**ï¼š
```
å¯åŠ¨ run.bat
    â†“
æ£€æŸ¥: Windowsä»»åŠ¡è®¡åˆ’ä¸­æ˜¯å¦å­˜åœ¨ TodoListReminder ä»»åŠ¡ï¼Ÿ
    â†“
    å¦ â†’ ç»§ç»­æ£€æŸ¥
    æ˜¯ â†’ ç›´æ¥å¯åŠ¨ç¨‹åº
    â†“
æ£€æŸ¥: database/config.json ä¸­ reminder.enabled æ˜¯å¦ä¸º trueï¼Ÿ
    â†“
    å¦ â†’ ç›´æ¥å¯åŠ¨ç¨‹åº
    æ˜¯ â†’ è‡ªåŠ¨è®¾ç½®å®šæ—¶ä»»åŠ¡
    â†“
åˆ›å»ºå®šæ—¶ä»»åŠ¡:
  â€¢ ä»»åŠ¡å: TodoListReminder
  â€¢ å‘½ä»¤: project.exe --check-reminders
  â€¢ é¢‘ç‡: æ¯60åˆ†é’Ÿ
  â€¢ æƒé™: å½“å‰ç”¨æˆ·
    â†“
å¯åŠ¨ç¨‹åº
```

**å…³é”®ä»£ç **ï¼š
- æ£€æŸ¥ä»»åŠ¡æ˜¯å¦å­˜åœ¨ï¼š`Get-ScheduledTask -TaskName 'TodoListReminder'`
- è¯»å–JSONé…ç½®ï¼š`Get-Content 'database\config.json' | ConvertFrom-Json`
- åˆ›å»ºå®šæ—¶ä»»åŠ¡ï¼š`Register-ScheduledTask`

### 2. æé†’åŠŸèƒ½å¼€å…³ï¼ˆ`src/cli/setting_cli.rs`ï¼‰

**åŠŸèƒ½**ï¼šå¯ç”¨æé†’åŠŸèƒ½åè¯¢é—®ç”¨æˆ·æ˜¯å¦é‡å¯

**å¢å¼ºå†…å®¹**ï¼š
```rust
match choice {
    "1" => {
        let was_enabled = current_enabled;
        update_reminder_enabled(json_config, true)?;
        println!("âœ… æé†’åŠŸèƒ½å·²å¯ç”¨");
        
        // å¦‚æœä¹‹å‰æ˜¯ç¦ç”¨çŠ¶æ€ï¼Œç°åœ¨å¯ç”¨äº†ï¼Œè¯¢é—®æ˜¯å¦é‡å¯
        if !was_enabled {
            println!();
            println!("ğŸ’¡ æé†’åŠŸèƒ½å·²å¯ç”¨ï¼Œå»ºè®®é‡å¯ç¨‹åºä»¥ä¾¿ç«‹å³ç”Ÿæ•ˆ");
            println!("   ç¨‹åºé‡å¯æ—¶ä¼šè‡ªåŠ¨è®¾ç½®å®šæ—¶ä»»åŠ¡ï¼ˆå¦‚æœå°šæœªè®¾ç½®ï¼‰");
            println!();
            print!("æ˜¯å¦ç°åœ¨é‡å¯ç¨‹åºï¼Ÿ(Y/N): ");
            io::stdout().flush()?;
            
            let mut restart_input = String::new();
            io::stdin().read_line(&mut restart_input)?;
            
            if restart_input.trim().eq_ignore_ascii_case("y") {
                println!();
                println!("ğŸ”„ æ­£åœ¨é‡å¯ç¨‹åº...");
                println!("ğŸ‘‹ å†è§ï¼");
                std::process::exit(0);
            } else {
                println!("ğŸ’¡ æ‚¨ä¹Ÿå¯ä»¥æ‰‹åŠ¨é€€å‡ºç¨‹åºåé‡æ–°å¯åŠ¨");
            }
        }
    }
    "2" => {
        update_reminder_enabled(json_config, false)?;
        println!("âŒ æé†’åŠŸèƒ½å·²ç¦ç”¨");
        println!("ğŸ’¡ å®šæ—¶ä»»åŠ¡ä¸ä¼šè¢«åˆ é™¤ï¼Œæ‚¨å¯ä»¥ç¨åé‡æ–°å¯ç”¨");
    }
    // ...
}
```

**å…³é”®ç‚¹**ï¼š
- åªåœ¨çŠ¶æ€æ”¹å˜ï¼ˆä»ç¦ç”¨åˆ°å¯ç”¨ï¼‰æ—¶è¯¢é—®é‡å¯
- æä¾›æ˜ç¡®çš„æç¤ºä¿¡æ¯
- ä½¿ç”¨ `std::process::exit(0)` ä¼˜é›…é€€å‡º

### 3. å¸®åŠ©ä¿¡æ¯æ›´æ–°ï¼ˆ`src/service/help.rs`ï¼‰

**å†…å®¹**ï¼š
```
âš™ï¸  Setting æ¨¡å¼ä¸“ç”¨å‘½ä»¤:
  reminder         - æé†’åŠŸèƒ½å¼€å…³è®¾ç½®ï¼ˆå¯ç”¨åé‡å¯ç¨‹åºè‡ªåŠ¨è®¾ç½®å®šæ—¶ä»»åŠ¡ï¼‰
  reminder-status  - æŸ¥çœ‹æé†’åŠŸèƒ½çŠ¶æ€
  reminder-history - æŸ¥çœ‹æé†’å†å²è®°å½•
  reminder-cleanup - æ¸…ç†æ—§æé†’å†å²
  test-reminder    - æµ‹è¯•æé†’åŠŸèƒ½

ğŸ’¡ æç¤º: å¯ç”¨æé†’åŠŸèƒ½åï¼Œç¨‹åºä¼šåœ¨é‡å¯æ—¶è‡ªåŠ¨è®¾ç½®å®šæ—¶ä»»åŠ¡ï¼ˆæ¯å°æ—¶æ£€æŸ¥ä¸€æ¬¡ï¼‰
```

## ğŸ¯ ç”¨æˆ·ä½“éªŒæµç¨‹

### å®Œæ•´ä½¿ç”¨æµç¨‹

```
ç”¨æˆ·å¯åŠ¨åº”ç”¨
    â†“
è¿›å…¥settingæ¨¡å¼
    â†“
æ‰§è¡Œ reminder å‘½ä»¤
    â†“
é€‰æ‹© 1ï¼ˆå¯ç”¨æé†’åŠŸèƒ½ï¼‰
    â†“
âœ… æé†’åŠŸèƒ½å·²å¯ç”¨
ğŸ’¡ å»ºè®®é‡å¯ç¨‹åº...
æ˜¯å¦ç°åœ¨é‡å¯ç¨‹åºï¼Ÿ(Y/N): Y
    â†“
ç¨‹åºé€€å‡º
    â†“
ç”¨æˆ·å†æ¬¡è¿è¡Œ scripts\run.bat
    â†“
â° æ£€æµ‹åˆ°æé†’åŠŸèƒ½å·²å¯ç”¨ï¼Œä½†æœªè®¾ç½®å®šæ—¶ä»»åŠ¡
ğŸ’¡ æ­£åœ¨è‡ªåŠ¨è®¾ç½®å®šæ—¶ä»»åŠ¡...
âœ… å®šæ—¶ä»»åŠ¡è®¾ç½®æˆåŠŸï¼
âœ… æé†’åŠŸèƒ½å·²å¯ç”¨ï¼ˆæ¯å°æ—¶æ£€æŸ¥ä¸€æ¬¡ï¼‰
    â†“
ç¨‹åºæ­£å¸¸å¯åŠ¨ï¼Œæé†’åŠŸèƒ½å®Œå…¨å¯ç”¨
```

### åç»­å¯åŠ¨æµç¨‹

```
ç”¨æˆ·è¿è¡Œ scripts\run.bat
    â†“
æ£€æµ‹åˆ°å®šæ—¶ä»»åŠ¡å·²å­˜åœ¨
    â†“
ç›´æ¥å¯åŠ¨ç¨‹åº
```

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### å¯åŠ¨è„šæœ¬æ ¸å¿ƒé€»è¾‘

```batch
REM æ£€æŸ¥æé†’ä»»åŠ¡æ˜¯å¦å·²è®¾ç½®
powershell -Command "Get-ScheduledTask -TaskName 'TodoListReminder' -ErrorAction SilentlyContinue" >nul 2>&1
if %errorlevel% neq 0 (
    REM æ£€æŸ¥JSONé…ç½®ä¸­æé†’åŠŸèƒ½æ˜¯å¦å¯ç”¨
    powershell -Command "$json = Get-Content 'database\config.json' -Raw -ErrorAction SilentlyContinue | ConvertFrom-Json; if ($json.reminder.enabled -eq $true) { exit 0 } else { exit 1 }" >nul 2>&1
    if %errorlevel% equ 0 (
        REM è‡ªåŠ¨è®¾ç½®å®šæ—¶ä»»åŠ¡ï¼ˆä½¿ç”¨é»˜è®¤å‚æ•°ï¼šæ¯å°æ—¶æ‰§è¡Œä¸€æ¬¡ï¼‰
        powershell -ExecutionPolicy Bypass -Command "..."
    )
)
```

### å®šæ—¶ä»»åŠ¡åˆ›å»ºå‚æ•°

```powershell
$action = New-ScheduledTaskAction `
    -Execute $exePath `
    -Argument '--check-reminders' `
    -WorkingDirectory $projectPath

$trigger = New-ScheduledTaskTrigger `
    -Once `
    -At (Get-Date) `
    -RepetitionInterval (New-TimeSpan -Minutes 60) `
    -RepetitionDuration ([TimeSpan]::MaxValue)

$settings = New-ScheduledTaskSettingsSet `
    -AllowStartIfOnBatteries `
    -DontStopIfGoingOnBatteries `
    -StartWhenAvailable `
    -RunOnlyIfNetworkAvailable:$false `
    -ExecutionTimeLimit (New-TimeSpan -Minutes 5) `
    -RestartCount 3 `
    -RestartInterval (New-TimeSpan -Minutes 1)

$principal = New-ScheduledTaskPrincipal `
    -UserId $env:USERNAME `
    -LogonType Interactive `
    -RunLevel Limited
```

## ğŸ“Š å¯¹æ¯”åˆ†æ

### V1ç‰ˆæœ¬ï¼ˆæ‰‹åŠ¨è®¾ç½®ï¼‰

| æ­¥éª¤ | æ“ä½œ | éš¾åº¦ |
|------|------|------|
| 1 | ç¼–è¯‘é¡¹ç›® | â­â­ |
| 2 | æ‰¾åˆ°setup_reminder_task.ps1 | â­â­ |
| 3 | ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œè„šæœ¬ | â­â­â­ |
| 4 | æŒ‰ç…§å‘å¯¼é€‰æ‹©å‚æ•° | â­â­ |
| 5 | å¯åŠ¨åº”ç”¨ | â­ |

**æ€»éš¾åº¦ï¼šâ­â­â­â­â­â­â­â­â­â­ (10æ˜Ÿ)**

### V2ç‰ˆæœ¬ï¼ˆè‡ªåŠ¨è®¾ç½®ï¼‰

| æ­¥éª¤ | æ“ä½œ | éš¾åº¦ |
|------|------|------|
| 1 | å¯åŠ¨åº”ç”¨ | â­ |
| 2 | settingæ¨¡å¼ â†’ reminder â†’ é€‰æ‹©1 | â­ |
| 3 | é€‰æ‹©é‡å¯ (Y) | â­ |
| 4 | å†æ¬¡å¯åŠ¨åº”ç”¨ | â­ |

**æ€»éš¾åº¦ï¼šâ­â­â­â­ (4æ˜Ÿ)**

**é™ä½äº†60%çš„æ“ä½œå¤æ‚åº¦ï¼** ğŸ‰

## âœ¨ ä¼˜åŠ¿æ€»ç»“

1. **é›¶å­¦ä¹ æˆæœ¬**ï¼šç”¨æˆ·æ— éœ€äº†è§£Windowsä»»åŠ¡è®¡åˆ’ç¨‹åº
2. **è‡ªåŠ¨åŒ–**ï¼šå®Œå…¨è‡ªåŠ¨æ£€æµ‹å’Œè®¾ç½®ï¼Œæ— éœ€æ‰‹åŠ¨å¹²é¢„
3. **æ™ºèƒ½åŒ–**ï¼šåªåœ¨éœ€è¦æ—¶è®¾ç½®ï¼Œé¿å…é‡å¤æ“ä½œ
4. **ç”¨æˆ·å‹å¥½**ï¼šæ¸…æ™°çš„æç¤ºä¿¡æ¯ï¼Œå¼•å¯¼ç”¨æˆ·å®Œæˆè®¾ç½®
5. **å®¹é”™æ€§å¼º**ï¼šå³ä½¿å®šæ—¶ä»»åŠ¡è¢«åˆ é™¤ï¼Œä¸‹æ¬¡å¯åŠ¨ä¼šè‡ªåŠ¨é‡å»º
6. **çµæ´»æ€§**ï¼šå¯ä»¥éšæ—¶å¯ç”¨/ç¦ç”¨ï¼Œæ— éœ€å…³å¿ƒåº•å±‚ç»†èŠ‚

## ğŸŠ å®ŒæˆçŠ¶æ€

- âœ… æ™ºèƒ½å¯åŠ¨è„šæœ¬ï¼ˆè‡ªåŠ¨æ£€æµ‹å’Œè®¾ç½®ï¼‰
- âœ… æé†’åŠŸèƒ½å¼€å…³ï¼ˆè¯¢é—®é‡å¯ï¼‰
- âœ… å¸®åŠ©ä¿¡æ¯æ›´æ–°
- âœ… ç¼–è¯‘æµ‹è¯•é€šè¿‡
- âœ… æ–‡æ¡£å®Œå–„
- âœ… ç”¨æˆ·ä½“éªŒä¼˜åŒ–

**æ‰€æœ‰åŠŸèƒ½å·²å®Œæ•´å®ç°å¹¶æµ‹è¯•é€šè¿‡ï¼** ğŸš€

